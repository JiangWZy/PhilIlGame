
<!DOCTYPE html>

<html>

<head>

    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>

</head>

<body>

    <script>
    //comment here
    //Who is Joe!??????
    var config = {
        type: Phaser.AUTO,
        width: 1400,
        height: 1050,
        physics: {
            default: 'arcade',
        },
        backgroundColor: '#047e7e',
        scene: {
            preload: preload,
            create: create,
            update: update,
        }

    };

    class Player extends Phaser.Physics.Arcade.Sprite
    {
        animations;
<<<<<<< HEAD
        constructor(scene, x, y)
=======
        totalJumps = 2;
        currentJumps = 0;
        constructor(scene, x, y, spritesheet, animations)
>>>>>>> 977668141ec2a587cf1139cb03b3269de311e09b
        {
            super(scene, x, y, spritesheet);
            this.animations = animations;
            scene.add.existing(this);
            scene.physics.add.existing(this);
            this.setScale(1);
            this.setCollideWorldBounds(true);
            this.setGravityY(3000); //We will set gravity *per object* rather than for the scene!
        }
    }

    class Carrot extends Phaser.Physics.Arcade.Sprite
    {
        constructor(scene, x, y)
        {
            super(scene, x, y, 'carrot');
            scene.add.existing(this);
            scene.physics.add.existing(this);
            this.setCollideWorldBounds(true);
            this.setGravityY(1000);
        }
    }

    var game = new Phaser.Game(config);

    //Game Objects
    var platforms;
    var player;
    var carrots = [];
    var totalCarrots = 24;
    var score = 0;

    var graphics;
    var line;

    var pX;
    var pY;

    //Keyboard controls
    var cursors;
    var keys;
    var space;

    var gui;
    var guiTimer;
    var sprite;



    //grant - loads EVERYTHING (background, assets, etc.)
    function preload()
    {
      this.load.image('sky', 'assets/clouds.png');
      this.load.image('platform', 'assets/platform.png');
      this.load.image('doublejump', 'assets/mutations/doubleJumpMutationIcon.png');
      this.load.image('laser', 'assets/mutations/laserMutationIcon.png');
      this.load.image('shield', 'assets/mutations/shieldMutationIcon.png');
      this.load.image('lassoHead', 'assets/lasso/lassoHead.png');
      this.load.image('lassoString', 'assets/lasso/lassoString.png');
<<<<<<< HEAD
      this.load.atlas('player', 'assets/firewallminion/FirewallMinionWalking.png','assets/firewallminion/FirewallMinionWalkingJSON.json');
      this.load.image('carrot', 'assets/mutations/Energy.png');
=======
      this.load.atlas('player', 'assets/firewallminion/FirewallMinionSpritesheet.png','assets/firewallminion/FirewallMinionSpritesheet.json');
>>>>>>> 977668141ec2a587cf1139cb03b3269de311e09b
    }

    function create()
    {
      //creates the animations UGHHHHHHHHHHHHHHHHHHHHHHHHHHHHH >:(
      this.anims.create({key: 'player', frames: this.anims.generateFrameNames('FirewallMinionWalking', {prefix: 'player', end: 5, zeroPad: 4}), repeat: -1});

      let playerAnimations = {};
      var left = this.anims.create({key: 'slime_left', frames: this.anims.generateFrameNames('slime', {prefix: 'player', end: 5, zeroPad: 2}), repeat: -1, frameRate: 10});
      playerAnimations['left'] = left;

<<<<<<< HEAD
      //this block of code adds the bunny and makes it so when you click it, it turns green
=======
      //adds sky
      this.add.image(400, 400, 'sky');

      //creates the animations UGHHHHHHHHHHHHHHHHHHHHHHHHHHHHH >:(
      let playerAnimations = [];
      var left = this.anims.create({key: 'move_left', frames: this.anims.generateFrameNames('player', {prefix: 'FirewallMinionWalking', end: 3, zeroPad: 4}), repeat: -1, frameRate:4});
      playerAnimations['left'] = left;
      var right = this.anims.create({key: 'move_right', frames: this.anims.generateFrameNames('player', {prefix: 'FirewallMinionWalking', end: 3, zeroPad: 4}), repeat: -1, frameRate: 10});
      playerAnimations['right'] = right;

      //this block of code adds the bunny and makes it so when you click it, it turns red
>>>>>>> 977668141ec2a587cf1139cb03b3269de311e09b
      sprite = this.add.sprite(400,300, 'player').setInteractive();
      this.physics.add.existing(sprite);
      //makes bunny unable to be moved
      sprite.body.immovable = true;

       sprite.on('pointerdown', function (pointer) {
         this.setTint(0x00ff00);
       });
       sprite.on('pointerout', function (pointer) {
         this.clearTint();
       });
       sprite.on('pointerup', function (pointer) {
         this.clearTint();
       });

       //end bunny green

        graphics = this.add.graphics();

<<<<<<< HEAD
=======

       //allows platform to be draggable only once
       let dragCount = 1;
       if(dragCount > 0)
       {
>>>>>>> 977668141ec2a587cf1139cb03b3269de311e09b
         this.input.setDraggable(sprite);

        this.input.on('drag', function (pointer, gameObject, dragX, dragY){
           gameObject.x = dragX;
           gameObject.y = dragY;
           //pX = gameObject.x;
          // pY = gameObject.y;
          graphics.lineStyle(10, 0x000000, 1);

        //  graphics.destroy();
        //  graphics.setVisible(false);

         });


         this.input.on('drag', function (pointer, gameObject) {

           gameObject.clearTint();
         });


       //Create the platforms and the player character set to collide with the platforms
       createPlatforms(this);

       player = new Player(this, 400, 400, 'player', playerAnimations);
       this.physics.add.collider(player, platforms,);
       this.physics.add.collider(player, sprite);


       //Create the carrot interactables
       for (var i = 0; i < totalCarrots; i++)
       {
           let myCarrot = new Carrot(this, Phaser.Math.Between(0, game.scale.width), Phaser.Math.Between(0, game.scale.height-80));
           this.physics.add.collider(myCarrot, platforms);
           carrots.push(myCarrot);
       }

       this.physics.add.overlap(player, carrots, eatCarrot, null, this);

       //Set up user input
       cursors = this.input.keyboard.createCursorKeys();
       keys = this.input.keyboard.addKeys('A, D');
       space = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);
       space.on('down', jump); //calls jump function when space is pressed

       gui = this.add.text(16, 16, '', {fontSize: '32px', fill: '#000'});
<<<<<<< HEAD
=======
       //player coords
       //var x = player.x;
       //var y = player.y;
       //var r1 = this.add.line(200, 200, 0, 0, 140, 90, 0xffffff);
>>>>>>> 977668141ec2a587cf1139cb03b3269de311e09b

    }

    function createPlatforms(scene)
    {
        platforms = scene.physics.add.staticGroup();
        platforms2 = scene.physics.add.staticGroup()

        //basePlatform is the floor of the game
        let basePlatform = platforms.create(game.scale.width/2, game.scale.height-30, 'platform');
        basePlatform.setScale(3, 1).refreshBody(); //scales the base platform in the x axis to cover the entire floor

        platforms.create(250, 350, 'platform'); //creates the upper left platform
        platforms.create(950, 500, 'platform'); //creates the bottome right platform
        platforms.create(400, 100, 'platform'); //third platform baybee
        platforms.create(1000, 200, 'platform'); //anotha won





    }

    function update()
    {
        if(game.input.mousePointer.isDown)
        {
          graphics.clear();
          graphics.lineStyle(5, 0x000000, 1);
          graphics.lineBetween(player.x, player.y, sprite.x, sprite.y);

        }
        if(game.input.mousePointer.isUp)
        {
          graphics.clear();
        }


        if(totalCarrots > 0){
        //Player will not move in the x-axis unless a movement key is being pressed
          player.setVelocityX(0);

          //Player has "drag" on the x-axis meaning they slide a bit after an input
          player.setDragX(1000);

          //This will reset the number of jumps available to the player whenever the player lands
          if (player.body.touching.down) {
              player.currentJumps = 0;
          }

          //Handle player movements
          if (cursors.left.isDown || keys.A.isDown)
          {
              player.setVelocityX(-400);
              player.play(player.animations['left'], true);
              player.flipX = false
          }

          if (cursors.right.isDown || keys.D.isDown)
          {
              player.setVelocityX(400);
              player.play(player.animations['right'], true);
              player.flipX = true
          }
      }
    }

    function jump(event)
    {
        if (player.body.touching.down) {
          //If the player is on the ground, the player can jump
          player.setVelocityY(-850);
          player.currentJumps++;
        }
    }

    //This function is called when a player overlaps with a carrot
    function eatCarrot(player, carrot)
    {
        carrot.disableBody(true, true); //remove that particular carrot from the game (physics and visibility)
        score += 1;
        gui.setText('Your score: ' + score);
        guiTimer = this.time.delayedCall(1000, removeText, [], this);
        totalCarrots--;
        if(totalCarrots === 0){
          gui.setText("Congratulations! You have completed the level!");
          guiTimer = this.time.delayedCall([], this);
        }
    }

    //Reset the gui text to be empty after the guiTimer elapses
    function removeText()
    {
        gui.setText('');
    }

    </script>

</body>

</html>
